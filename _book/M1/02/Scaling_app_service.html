
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>2.3. Scale apps in Azure App Service · HonKit</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 4.0.4">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Azure_app_service_deploy.html" />
    
    
    <link rel="prev" href="Config_app_service.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">About</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    AZURE JOURNEY
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Develop Azure Compute Solutions</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../01/">
            
                <a href="../01/">
            
                    
                    1. Implement IaaS solutions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../01/Provision_vm.html">
            
                <a href="../01/Provision_vm.html">
            
                    
                    1.1. Provision virtual machines in Azure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../01/Create_arm.html">
            
                <a href="../01/Create_arm.html">
            
                    
                    1.2. Create and deploy Azure Resource Manager templates
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="../01/Manage_container.html">
            
                <a href="../01/Manage_container.html">
            
                    
                    1.3. Manage container images in Azure Container Registry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="../01/Run_container.html">
            
                <a href="../01/Run_container.html">
            
                    
                    1.4 Run container images in Azure Container Instances
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Hands-on LABS</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../01/lab01.html">
            
                <a href="../01/lab01.html">
            
                    
                    Lab 01 - Create a VM by using the Azure Command-Line Interface (CLI)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../01/lab02.html">
            
                <a href="../01/lab02.html">
            
                    
                    Lab 02 - Create a Docker container image and deploy it to Azure Container Registry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../01/lab03.html">
            
                <a href="../01/lab03.html">
            
                    
                    Lab 03 - Deploy an Azure container instance
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="./">
            
                <a href="./">
            
                    
                    2. Create Azure App Service Web Apps
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="Azure_app_service.html">
            
                <a href="Azure_app_service.html">
            
                    
                    2.1. Explore Azure App Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="Config_app_service.html">
            
                <a href="Config_app_service.html">
            
                    
                    2.2. Configure web app settings
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="4.1.3" data-path="Scaling_app_service.html">
            
                <a href="Scaling_app_service.html">
            
                    
                    2.3. Scale apps in Azure App Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4" data-path="Azure_app_service_deploy.html">
            
                <a href="Azure_app_service_deploy.html">
            
                    
                    2.4. Explore Azure App Service deployment slots
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Hands-on Labs</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="lab01.html">
            
                <a href="lab01.html">
            
                    
                    LAB 01 - Build a backend API by using Azure Storage and the Web Apps feature of Azure App Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="lab02.html">
            
                <a href="lab02.html">
            
                    
                    LAB 02 - Build a front-end web application by using Azure Web Apps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="lab03.html">
            
                <a href="lab03.html">
            
                    
                    LAB 03 - Clean up your subscription
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../03/">
            
                <a href="../03/">
            
                    
                    3. Implemente Azure functions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.1" data-path="../03/Azure_functions.html">
            
                <a href="../03/Azure_functions.html">
            
                    
                    3.1. Explore Azure Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.2" data-path="../03/Develop_azure_functions.html">
            
                <a href="../03/Develop_azure_functions.html">
            
                    
                    3.2. Develop Azure Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.3" data-path="../03/Implement_functions.html">
            
                <a href="../03/Implement_functions.html">
            
                    
                    3.3. Implement Durable Functions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Hands-on Labs</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../03/lab01.html">
            
                <a href="../03/lab01.html">
            
                    
                    LAB 01 - Create Azure resources
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="../03/lab02.html">
            
                <a href="../03/lab02.html">
            
                    
                    LAB 02 - Configure a local Azure Functions project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="../03/lab03.html">
            
                <a href="../03/lab03.html">
            
                    
                    LAB 03 - Create a function that’s triggered by an HTTP request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.4" data-path="../03/lab04.html">
            
                <a href="../03/lab04.html">
            
                    
                    LAB 04 - Create a function that triggers on a schedule
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.5" data-path="../03/lab05.html">
            
                <a href="../03/lab05.html">
            
                    
                    LAB 05 - Create a function that integrates with other services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.6" data-path="../03/lab06.html">
            
                <a href="../03/lab06.html">
            
                    
                    LAB 06 - Deploy a local function project to an Azure Functions app
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.7" data-path="../03/lab07.html">
            
                <a href="../03/lab07.html">
            
                    
                    LAB 07 - Clean up your subscription
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Develop for Azure storage</li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../../M2/01/">
            
                <a href="../../M2/01/">
            
                    
                    4. Develop solutions that use Cosmos DB storage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="../../M2/02/">
            
                <a href="../../M2/02/">
            
                    
                    5. Develop solutions that use blob storage
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >2.3. Scale apps in Azure App Service</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="autoscale-factors">Autoscale factors</h2>
<p>Autoscaling can be triggered according to a schedule, or by assessing whether the system is running short on resources. For example, autoscaling could be triggered if CPU utilization grows, memory occupancy increases, the number of incoming requests to a service appears to be surging, or some combination of factors.</p>
<p><img src="images/Scale_app_01.png" alt="alt text"></p>
<h3 id="autoscaling-rules">Autoscaling rules</h3>
<p>Autoscaling makes its decisions based on rules that you define. A rule specifies the threshold for a metric, and triggers an autoscale event when this threshold is crossed. Autoscaling can also deallocate resources when the workload has diminished.</p>
<p>Define your autoscaling rules carefully. For example, a Denial of Service attack will likely result in a large-scale influx of incoming traffic. Trying to handle a surge in requests caused by a DoS attack would be fruitless and expensive. These requests aren&apos;t genuine, and should be discarded rather than processed. A better solution is to implement detection and filtering of requests that occur during such an attack before they reach your service.</p>
<p><br></p>
<h2 id="identify-autoscale-factors">Identify autoscale factors</h2>
<p>Autoscaling enables you to specify the conditions under which a web app should be scaled out, and back in again. Effective autoscaling ensures sufficient resources are available to handle large volumes of requests at peak times, while managing costs when the demand drops.</p>
<p><img src="images/Scale_app_02.png" alt="alt text"></p>
<h3 id="autoscale-conditions">Autoscale conditions</h3>
<p>You indicate how to autoscale by creating autoscale conditions. Azure provides two options for autoscaling:</p>
<ul>
<li>Scale based on a metric, such as the length of the disk queue, or the number of HTTP requests awaiting processing.</li>
<li>Scale to a specific instance count according to a schedule. For example, you can arrange to scale out at a particular time of day, or on a specific date or day of the week. You also specify an end date, and the system will scale back in at this time.</li>
</ul>
<h3 id="metrics-for-autoscale-rules">Metrics for autoscale rules</h3>
<p>Autoscaling by metric requires that you define one or more autoscale rules. An autoscale rule specifies a metric to monitor, and how autoscaling should respond when this metric crosses a defined threshold. The metrics you can monitor for a web app are:</p>
<ul>
<li><strong>CPU Percentage</strong>. This metric is an indication of the CPU utilization across all instances. A high value shows that instances are becoming CPU-bound, which could cause delays in processing client requests.</li>
<li><strong>Memory Percentage</strong>. This metric captures the memory occupancy of the application across all instances. A high value indicates that free memory could be running low, and could cause one or more instances to fail.</li>
<li><strong>Disk Queue Length</strong>. This metric is a measure of the number of outstanding I/O requests across all instances. A high value means that disk contention could be occurring.</li>
<li><strong>Http Queue Length</strong>. This metric shows how many client requests are waiting for processing by the web app. If this number is large, client requests might fail with HTTP 408 (Timeout) errors.</li>
<li><strong>Data In</strong>. This metric is the number of bytes received across all instances.</li>
<li><strong>Data Out</strong>. This metric is the number of bytes sent by all instances.</li>
</ul>
<h3 id="combining-autoscale-rules">Combining autoscale rules</h3>
<p>A single autoscale condition can contain several autoscale rules (for example, a scale-out rule and the corresponding scale-in rule). However, the autoscale rules in an autoscale condition don&apos;t have to be directly related. You could define the following four rules in the same autoscale condition:</p>
<ul>
<li>If the HTTP queue length exceeds 10, scale out by 1</li>
<li>If the CPU utilization exceeds 70%, scale out by 1</li>
<li>If the HTTP queue length is zero, scale in by 1</li>
<li>If the CPU utilization drops below 50%, scale in by 1</li>
</ul>
<p><br></p>
<h2 id="enable-autoscale-in-app-service">Enable autoscale in App Service</h2>
<p>To get started with autoscaling navigate to your App Service plan in the Azure portal and select Scale out (App Service plan) in the Settings group in the left navigation pane.</p>
<p>By default, an App Service Plan only implements manual scaling. Selecting <strong>Custom autoscale</strong> reveals condition groups you can use to manage your scale settings.</p>
<p><img src="images/Scale_app_03.png" alt="alt text"></p>
<h3 id="add-scale-conditions">Add scale conditions</h3>
<p>Once you enable autoscaling, you can edit the automatically created default scale condition, and you can add your own custom scale conditions. Remember that each scale condition can either scale based on a metric, or scale to a specific instance count.</p>
<p>The Default scale condition is executed when none of the other scale conditions are active.</p>
<p><img src="images/Scale_app_04.png" alt="alt text"></p>
<p>A metric-based scale condition can also specify the minimum and maximum number of instances to create. The maximum number can&apos;t exceed the limits defined by the pricing tier. Additionally, all scale conditions other than the default may include a schedule indicating when the condition should be applied.</p>
<h3 id="create-scale-rules">Create scale rules</h3>
<p>A metric-based scale condition contains one or more scale rules. You use the <strong>Add a rule</strong> link to add your own custom rules. You define the criteria that indicate when a rule should trigger an autoscale action, and the autoscale action to be performed (scale out or scale in) using the metrics, aggregations, operators, and thresholds described earlier.</p>
<p><img src="images/Scale_app_05.png" alt="alt text"></p>
<h3 id="monitor-autoscaling-activity">Monitor autoscaling activity</h3>
<p>The Azure portal enables you to track when autoscaling has occurred through the <strong>Run history</strong> chart. This chart shows how the number of instances varies over time, and which autoscale conditions caused each change.</p>
<p><img src="images/Scale_app_06.png" alt="alt text"></p>
<p>You can use the <strong>Run history</strong> chart in conjunction with the metrics shown on the <strong>Overview</strong> page to correlate the autoscaling events with resource utilization.</p>
<p><img src="images/Scale_app_07.png" alt="alt text"></p>
<p><br></p>
<h2 id="autoscale-best-practices">Autoscale best practices</h2>
<p><img src="images/Scale_app_08.png" alt="alt text"></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Config_app_service.html" class="navigation navigation-prev " aria-label="Previous page: 2.2. Configure web app settings">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Azure_app_service_deploy.html" class="navigation navigation-next " aria-label="Next page: 2.4. Explore Azure App Service deployment slots">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"2.3. Scale apps in Azure App Service","level":"4.1.3","depth":2,"next":{"title":"2.4. Explore Azure App Service deployment slots","level":"4.1.4","depth":2,"path":"M1/02/Azure_app_service_deploy.md","ref":"M1/02/Azure_app_service_deploy.md","articles":[]},"previous":{"title":"2.2. Configure web app settings","level":"4.1.2","depth":2,"path":"M1/02/Config_app_service.md","ref":"M1/02/Config_app_service.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"M1/02/Scaling_app_service.md","mtime":"2022-12-19T22:08:56.000Z","type":"markdown"},"gitbook":{"version":"4.0.4","time":"2022-12-20T18:49:37.311Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

